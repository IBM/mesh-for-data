{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "$id": "policymanager.schema.json#",
    "title": "Policy Manager Taxonomy",
    "description": "Portion of the taxonomy owned by the policy manager.",
    "definitions": {
        "action": {
            "type": "object",
            "description": "The action being requested on the data (ex: read, write...) and the geography in which it is to take place.",
            "properties": {
                "action_type": { "$ref": "policymanager.values.schema.json#/definitions/action_type" },
                "processingLocation": {
                    "type": "string",
                    "$ref": "catalog.values.schema.json#/definitions/geography_name"
                }
            },
            "required": ["action_type"]
        },
        "request_context": { "$ref":"policymanager.values.schema.json#/definitions/request_context"},
        "governance_decision_request": {
            "type": "object",
            "properties": {
                "request_context": { "$ref": "#/definitions/request_context"},
                "action": { "$ref":"#/definitions/action"},
                "resource": { "$ref": "catalog.structs.schema.json#/definitions/resource"}
            },
            "required": ["action", "resource"]
        },
        "governance_decision_response": {
            "type": "object",
            "description": "Governance decisions on the asset based on the enforced policies",
            "properties": {
				"decision_id": {
					"description": "This is the id returned by the governance engine",
					"type": "string"
				},
				"result" : { 
					"type": "array",
					"items": {
						"properties": {
							"action": {"$ref": "module.values.schema.json#/definitions/action"},
							"params": {
								"type": "array",
								"description": "List of optional parameters provided to the transform function.",
								"items": {
									"type":"string"
								}
							},
							"used_policy": {
								"description" : "The list of policies on which the decision was based.",
								"type": "string"
							}
						},
						"required":["action","used_policy"]                 
					}
				}
			},
            "required": ["result"]
        }
    },
    "properties": {
        "request_context": { "$ref": "#/definitions/request_context"},
        "action": { "$ref":"#/definitions/action"},
        "governance_decision_request": { "$ref":"#/definitions/governance_decision_request"},
        "governance_decision_response": { "$ref":"#/definitions/governance_decision_response"}
    },
    "additionalProperties": false
}