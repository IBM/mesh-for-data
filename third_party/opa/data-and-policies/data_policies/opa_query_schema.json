{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "$id": "github.com/ibm/the-mesh-for-data/third_party/opa/data-and-policies/opa_query_schema.json",
    "title": "OPA Request",
    "description": "The query structure used to request a decision from OPA",
    "allOf": [
        {
            "type": "object",
            "required": ["requester"], 
            "properties": {
                "requester": {"$ref": "../../../../pkg/taxonomy/policy_manager_schema.json#/definitions/requester"}            
            }
        },
        {
            "type": "object",
            "required": ["action"], 
            "properties": {
                "action": {"$ref": "../../../../pkg/taxonomy/policy_manager_schema.json#/definitions/action"}
            }
        },       
        {
            "type": "object",
            "required": ["resource"], 
            "properties": {
                "resource": {"$ref": "../../../../pkg/taxonomy/data_catalog_schema.json#/definitions/resource"}
            }
        } 
     ]
}